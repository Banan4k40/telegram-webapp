<script>
    const BOT_TOKEN = "7633978350:AAGRf2rNJmFkCl2LVTGEXMw49z_FZJpQby0";
    const GROUP_ID_DID = -1002424881153;
    const GROUP_ID_PH = -1002417008521;
    let selectedLine = "";
    const userName = "ExampleUser"; // –ó–¥–µ—Å—å –º–æ–∂–Ω–æ –∑–∞–º–µ–Ω–∏—Ç—å –Ω–∞ –≤–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
    const userId = Math.floor(Math.random() * 1000000); // –°–ª—É—á–∞–π–Ω—ã–π ID –¥–ª—è —Ç–µ—Å—Ç–æ–≤

    function showLineButtons() {
        document.getElementById("complaintButton").style.display = "none";
        document.getElementById("lineButtons").style.display = "flex";
    }

    function showForm(lineType) {
        selectedLine = lineType;
        document.getElementById("lineButtons").style.display = "none";
        document.getElementById("formContainer").style.display = "flex";
    }

    document.getElementById('submitButton').addEventListener('click', async () => {
        const phoneNumber = document.getElementById('phoneNumber').value;
        const callTime = document.getElementById('callTime').value;
        const comment = document.getElementById('comment').value;

        if (!phoneNumber || !callTime) {
            alert("–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –æ–±–æ–≤'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è.");
            return;
        }

        const message = `
        üÜï –ù–æ–≤–∞ –∑–∞—è–≤–∫–∞:
        üìû –õ—ñ–Ω—ñ—è: ${selectedLine}
        ‚òéÔ∏è –ù–æ–º–µ—Ä: ${phoneNumber}
        ‚è∞ –ß–∞—Å –¥–∑–≤—ñ–Ω–∫–∞: ${callTime}
        üí¨ –ö–æ–º–µ–Ω—Ç–∞—Ä: ${comment}
        üë§ User: ${userName} (ID: ${userId})`;

        const groupId = selectedLine === "DID" ? GROUP_ID_DID : GROUP_ID_PH;

        try {
            const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    chat_id: groupId,
                    text: message,
                    parse_mode: "HTML",
                    reply_markup: JSON.stringify({
                        inline_keyboard: [[
                            { text: "–û—Ç–≤–µ—Ç–∏—Ç—å", callback_data: `answer_${userId}` }
                        ]]
                    })
                })
            });

            if (response.ok) {
                alert("–ó–∞—è–≤–∫–∞ —É—Å–ø—ñ—à–Ω–æ –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–∞!");
                document.getElementById("formContainer").style.display = "none";
                document.getElementById("complaintButton").style.display = "flex";
            } else {
                alert("–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –∑–∞—è–≤–∫–∏.");
            }
        } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–ø—Ä–∞–≤–∫–∏:", error);
            alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –∑–∞—è–≤–∫—É.");
        }
    });

    async function handleAnswer(callbackData) {
        const reply = prompt("–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –æ—Ç–≤–µ—Ç:");
        if (!reply) {
            alert("–í–∏ –Ω–µ –≤–≤–µ–ª–∏ —Ç–µ–∫—Å—Ç –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.");
            return;
        }

        const userId = callbackData.split("_")[1];

        try {
            const response = await fetch(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage`, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    chat_id: userId,
                    text: `–í—ñ–¥–ø–æ–≤—ñ–¥—å –Ω–∞ –≤–∞—à—É –∑–∞—è–≤–∫—É:\n${reply}`,
                    parse_mode: "HTML"
                })
            });

            if (response.ok) {
                alert("–í—ñ–¥–ø–æ–≤—ñ–¥—å —É—Å–ø—ñ—à–Ω–æ –Ω–∞–¥—ñ—Å–ª–∞–Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—É!");
            } else {
                alert("–ü–æ–º–∏–ª–∫–∞ –Ω–∞–¥—Å–∏–ª–∞–Ω–Ω—è –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.");
            }
        } catch (error) {
            console.error("–ü–æ–º–∏–ª–∫–∞ –æ–±—Ä–æ–±–∫–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ:", error);
            alert("–ù–µ –≤–¥–∞–ª–æ—Å—è –Ω–∞–¥—ñ—Å–ª–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å.");
        }
    }
</script>
